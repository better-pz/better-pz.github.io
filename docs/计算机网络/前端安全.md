# 前端安全

## xss

XSS (cross-site scripting 跨域脚本攻击)

### xss 的攻击方式

**1. 反射型**

发出请求时，XSS 代码出现在 URL 中，作为输入提交到服务器端,服务器端解析后响应，XSS 代码随响应内容一起传回给浏览器,最后浏览器解析执行 XSS 代码。这个过程像一次反射，故叫反射型 XSS。\

- 写入后盾接口,并关闭浏览器自动拦截 xss

![在这里插入图片描述](https://img-blog.csdnimg.cn/20200330225133320.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B6MTAyMQ==,size_16,color_FFFFFF,t_70)

- 在 url 中输入攻击的脚本

![在这里插入图片描述](https://img-blog.csdnimg.cn/2020033022494918.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B6MTAyMQ==,size_16,color_FFFFFF,t_70)

![在这里插入图片描述](https://img-blog.csdnimg.cn/20200330225041532.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B6MTAyMQ==,size_16,color_FFFFFF,t_70)

**2. 存储型**

存储型 XSS 和反射型 XSS 的差别仅在于，提交的代码会存储在服务器端(数据库，内存，文件系统等)，下次请求目标页面时不用再提交 XSS 代码

### XSS 防范措施

1. 编码 :对用户输入的数据进行 HTML Entity 编码
   ![在这里插入图片描述](https://img-blog.csdnimg.cn/20200330230128505.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B6MTAyMQ==,size_16,color_FFFFFF,t_70)
2. 过滤

- 移除用户.上传的 DOM 属性，如 onerror 等
- 移除用户.上传的 Style 节点、Script 节 点、Iframe 节点等

3. 校正

- 避免直接对 HTML Entity 解码
- 使用 DOM Parse 转换， 校正不配对的 DOM 标签

## csrf

通常称为跨站请求伪造，英文名 Cross-site request forgery 缩写 CSRF

### 攻击原理

实现攻击的两大关键因素:

- 网站中的某个接口存在这种漏洞
- 用户确实在 A 注册网站确实的登录过
  ![在这里插入图片描述](https://img-blog.csdnimg.cn/20200330221721613.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B6MTAyMQ==,size_16,color_FFFFFF,t_70)

### CSRF 防御措施

- Token 验证
- Referer 验证
- 隐藏令牌
